This notebook will introduce the signal processing chapter and will include the following:

- what is a signal
- what is a peak
- What can we do with signals and peaks
- what is signal processing
- why might we need to process a signal
- by which methods is a signal processed
- what is the result of processing a signal.

2024-04-25 13:32:15

*an explanation to a chromatographer why we are so concerned with signal processing*

Generally speaking, a chromatographer will only move to peak integration after prefecting a seperation. They will target only a handful peaks in a sample and optimize the conditions to isolate these peaks. In untargeted metabolomic fingerprinting however, we are attempting to maximise the information output from a sample, and thus all peaks are equally valuable. As an organic compound consists of a huge range of compounds of varying chemical identity, we cannot optimize the separation beyond maximising the spread of peaks across the time dimension. Consequently, peak will most likely be convolved, the convolution may be higher in particular signal regions, and an uneven baseline is probable.

# Chromatograghic Signals

## What is a Signal

- in the simplest sense, a signal is a geometric description of how one physical phenomenon changes in response to another changing physical phenomenon. [@smith_2024, ch. 2, para. 1].
- A signal generally consists of a time of time-like independent variable and one or more dependent variables whose values are generated by a detector. The response of the detector to the independent variable contains information about the phenomenon in question. Commonly encountered signals include sounds that we hear, images that we see, and vibration that we feel.
- A signal consists of three entities - a baseline: generally considered the zero line of the x-axis, features: characteristics of the observed phenomenon containing desirable information, frequently taking the form of gaussian or gaussian-like peaks [@dong_2019, sect. 1.1.4, p. 13, para. 3], and background noise, containing all other variance from the zero baseline that is not a feature. Real-world signals often contain a non-zero baseline which is also considered background noise. One will generally process a received signal to remove all noise, leaving a zero-baseline and distinct features for downstream analysis.

## Analog and Digital Signals

- As chromatographic signals are time-based, we will limit the discussion of signals to those that exist within the time domain.
- Within the physical universe, time is continuous, and and as such contains an infinite number of data points of infinite detail Unfortunately, digital detectors are inherently limited in the level of detail, in the form of the observation sampling rate.
- Furthermore, computers possess a limit to the number of decimal places a data point can possess. Thus, a signal detected and processed by a computer consists of discrete time axis rather than continuous, and is known as a digital signal, in contrast to signals with a continuous time axis, known as an analog signal, analog being short for analogous, analogous of the natural signal.
- Therefore, due to these limitations, a digital signal is considered to be discrete rather than continuous, although for most purposes the level of detail provided by the sampling rate is fine enough that the signal can be considered an approximation of a continuous signal.

## What is a Chromatographic Signal

- A HPLC-DAD system produces a digital signal of the light absorbance of a sample over time.
- Features are found in the form of peaks generated as compounds pass by the detector.
- As a sample passes through a column they are dispersed across the time axis, ordered according to a balance between their chemical affinity to column solid phase and mobile phase.
- With fine-tuning of the various parameters of the chromatographic system, including the chemical properties of the solid phase, mobile phase, column length, temperature, and sample preparation, the individual compounds are isolated for detection.
- Ideally, the quantity of each compound would be detected in an instant, providing a single point representing its concentration as a function of its absorbance. However, due to random diffusion processes as the compounds traverse the column pores, the compounds are detected take on a Gaussian-like distribution centered on a mean elution time.

### Properties of Chromatographic Signals

### Peak Geometry

- If we are to model a chromatographic peak as a Gaussian distribition, then there are multiple deviations from the model:
  - the distribution can be skewed to the left or right of the time axis, known in chromatographic circles as fronting or tailing, and are caused by different mechanisms:
    - tailing is caused by compound-column adsorption or extra-column band broadening of the solute.
    - Fronting can be caused by column-overloading, or even by chemical reactions such as isomerization during seperation. [@dong_2019, p. 45, section 2.2.9, para. 2] (NTS: ensure this is an inline citation) gives the example of basic analytes such as amines which depict tailing due to interactions with acidic residuals present in silica-based stationary phases.

#### Measuring Peak Geometry

- [vitha_2017c, p. sect. 1.1.4, p. 14]
  - Peak Width is usually measured either:
    - baseline peak width. Measured as:
      - two tangents drawn either side of the peak, meeting above the maxima and intersecting with the baseline
      - the distance between the tangents at the baseline is taken as the peak width.
    - peak width at half maximum height. Measured as:
      - draw a line parallel to the x-axis at a height half the peak maxima.
      - at the intersections of the peak curve and the horizontal line, draw vertical lines orthogonal to the x-axis.
      - the distance between the vertical lines along the x-axis is the peak width at half maximum height.

### Methods of Scoring A Chromatographic Separation

- An ideal chromatographic separation will result in total isolation of the individual compounds of a mixture along the time axis.
- [@fanali_2023, ch. 3, p. 50, para. 4]

#### Theoretical Plate Number

##### Definition

  -  The "theoretical plate number" $N$:
    - measures the dispersion efficiency of a column
    - models the column as consisting of a series of layers, or plates, each with a unique affinity for a given member of the analyte mixture.
    - the more plates, the more specific they can be to each analyte, and thus each analyte is isolated and resolved by their destined plate.
    - as the mixture moves along the time axis of the chromatogram, it becomes increasingly pure as each analyte is captured by its respective plate.
    - Peak widths and heights are thus determined by the number of plates present in the column, more plates mean less width as all of an analyte will fall into one plate and not others.
    - There are many methods of calculating $N$, but the most common method is by The "half peak height method" where it is defined as: $$N = (t_r / \sigma)^2$$, or $$5.54 (t_r / W_{1/2})^2$$, where t_r is the mean peak retention time, sigma is the peak standard devation. if we assume a Gaussian peak model then the second calculation can be used [@fanali_2023, ch. 3 p. 50, para. 3; @vitha_2017c, p. 16, sect. 1.1.4, para. 2].
    - (NTS does that mean that if $N$ is to be the same along the chromatogram, then peak width needs to increase as time increases?)

##### Use

- It is a measurement of band broadening over time [@vitha_2017c, sect. 1.1.4, p. 16, para. 2]
- More plates mean that peak widths are tighter, meaning there is more space for peaks to be individually resolved. Thus it is a measure of efficiency


## Peak Overlap / Peak Resolution
- 
- As a PDA detector takes 1D spatial recordings, incomplete seperation of chemically similar compounds results in the observation of overlapped peaks. This is common in complex samples containing chemically similar compounds.
- As absorbance is additive, (NTS: need to cehck this) two overlapped peaks will obscure each others true form, overexagerating their:
  -  heights
  - kurtosis
  - skew
- overlap is more generally known as signal convolution
- 

## Assumptions of Signal processing

- Same x-axis spacing. To preserve the information 
- A key difference between an analog and
- Many signal processing algorithms are simplified by assuming that the signal exists within a uniformly spaced grid, analogous to square grid paper.
However, in the real world, detectors can develop irregularities in their detection, or miss an observation. It is thus common to treat all signals to a resampling regime prior to further processing. Generally the signal is resampled to the mean of the finite difference.
- for signal arithmetic to produce a meaningful result, all the terms of the equation are required to exist on the same x-axis, whose properties are defined by the
- A signals sampling rate can be reduced through the use of summary statistics, such as the average, to conserve information about the lost data points. Increasing the sampling rate is however impossible without interpolation of the new data points, typically a linear interpolation is chosen. It must be noted that the value of the interpolated points is questionable at best, and care must be taken taking quantitative measurements from interpolated points.
- If for example the difference is taken between a signal and itself at a lower sampling rate, then the original signal is in effect subtracted by an aggregation of itself. 